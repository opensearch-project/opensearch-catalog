{"id":"48dcf76d-9c41-44d2-8aff-058eff47297b","createdAt":1699312159365,"updatedAt":1706846246839,"text":"# This is a SimpleSchema for Observability based mapping setup integration \n# The OTEL schema defines the four signale which compose the root elements of the OTEL protocol. :\n\n# (Traces) Setup ss4o_traces_template\n# (Logs) Setup ss4o_logs_template\n# (Metrics) Setup ss4o_metrics_template\n# (Services) Setup ss4o_services_template\n\n# ------------------------------------------------------------------------------------------------------------------------------------\n#\n# The workflow includes the following steps\n#  - create a new `ss4o_traces_template` index template\n#  - create a new `ss4o_logs_template` index template\n#  - create a new `ss4o_metrics_template` index template\n#  - create a new `ss4o_services_template` index template\n\n\n# For Additional Information visit : https://github.com/opensearch-project/opensearch-catalog/integrations/observability/otel-schema-setup/info\n# ------------------------------------------------------------------------------------------------------------------------------------\n\n# Create the ss4o_traces_template index template \n# >> remove the \"data_stream\":{} line to apply for indices rahter than data-streams\nPUT  _index_template/ss4o_traces_template\n{\n  \"index_patterns\": [\n    \"ss4o_traces-*-*\"\n  ],\n  \"data_stream\": {},\n  \"template\": {\n    \"mappings\": {\n      \"_meta\": {\n        \"version\": \"1.0.0\",\n        \"catalog\": \"observability\",\n        \"type\": \"traces\",\n        \"component\": \"trace\",\n        \"correlations\": [\n          {\n            \"field\": \"serviceName\",\n            \"foreign-schema\": \"services\",\n            \"foreign-field\": \"spanId\"\n          }\n        ]\n      },\n      \"dynamic_templates\": [\n        {\n          \"events_attributes_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"events.attributes.*\"\n          }\n        },\n        {\n          \"links_attributes_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"links.attributes.*\"\n          }\n        },\n        {\n          \"instrumentation_scope_attributes_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"instrumentationScope.attributes.*\"\n          }\n        },\n        {\n          \"resources_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"resource.*\"\n          }\n        }\n      ],\n      \"_source\": {\n        \"enabled\": true\n      },\n      \"properties\": {\n        \"traceId\": {\n          \"ignore_above\": 256,\n          \"type\": \"keyword\"\n        },\n        \"spanId\": {\n          \"ignore_above\": 256,\n          \"type\": \"keyword\"\n        },\n        \"traceState\": {\n          \"type\": \"text\",\n          \"fields\": {\n            \"keyword\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 256\n            }\n          }\n        },\n        \"parentSpanId\": {\n          \"ignore_above\": 256,\n          \"type\": \"keyword\"\n        },\n        \"name\": {\n          \"ignore_above\": 1024,\n          \"type\": \"keyword\"\n        },\n        \"kind\": {\n          \"ignore_above\": 128,\n          \"type\": \"keyword\"\n        },\n        \"startTime\": {\n          \"type\": \"date_nanos\"\n        },\n        \"endTime\": {\n          \"type\": \"date_nanos\"\n        },\n        \"droppedAttributesCount\": {\n          \"type\": \"long\"\n        },\n        \"droppedEventsCount\": {\n          \"type\": \"long\"\n        },\n        \"droppedLinksCount\": {\n          \"type\": \"long\"\n        },\n        \"status\": {\n          \"properties\": {\n            \"code\": {\n              \"type\": \"long\"\n            },\n            \"message\": {\n              \"ignore_above\": 128,\n              \"type\": \"keyword\"\n            }\n          }\n        },\n        \"attributes\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"serviceName\": {\n              \"type\": \"keyword\"\n            },\n            \"data_stream\": {\n              \"properties\": {\n                \"dataset\": {\n                  \"ignore_above\": 128,\n                  \"type\": \"keyword\"\n                },\n                \"namespace\": {\n                  \"ignore_above\": 128,\n                  \"type\": \"keyword\"\n                },\n                \"type\": {\n                  \"ignore_above\": 56,\n                  \"type\": \"keyword\"\n                }\n              }\n            }\n          }\n        },\n        \"events\": {\n          \"type\": \"nested\",\n          \"properties\": {\n            \"name\": {\n              \"ignore_above\": 1024,\n              \"type\": \"keyword\"\n            },\n            \"@timestamp\": {\n              \"type\": \"date_nanos\"\n            },\n            \"observedTimestamp\": {\n              \"type\": \"date_nanos\"\n            }\n          }\n        },\n        \"links\": {\n          \"type\": \"nested\",\n          \"properties\": {\n            \"traceId\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"spanId\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"traceState\": {\n              \"type\": \"text\",\n              \"fields\": {\n                \"keyword\": {\n                  \"type\": \"keyword\",\n                  \"ignore_above\": 256\n                }\n              }\n            }\n          }\n        },\n        \"instrumentationScope\": {\n          \"properties\": {\n            \"name\": {\n              \"type\": \"keyword\"\n            },\n            \"version\": {\n              \"type\": \"keyword\"\n            },\n            \"droppedAttributesCount\": {\n              \"type\": \"integer\"\n            },\n            \"schemaUrl\": {\n              \"type\": \"keyword\"\n            }\n          }\n        },\n        \"schemaUrl\": {\n          \"type\": \"keyword\"\n        }\n      }\n    }\n  },\n  \"composed_of\": [],\n  \"version\": 1,\n  \"_meta\": {\n    \"description\": \"Observability Traces Mapping Template\",\n    \"catalog\": \"observability\",\n    \"type\": \"traces\",\n    \"correlations\": [\n      {\n        \"field\": \"serviceName\",\n        \"foreign-schema\": \"services\",\n        \"foreign-field\": \"serviceName\"\n      }\n    ]\n  }\n}\n\n# Create the ss4o_logs_template index template\n# >> remove the \"data_stream\":{} line to apply for indices rahter than data-streams\nPUT  _index_template/ss4o_logs_template\n{\n  \"index_patterns\": [\"ss4o_logs-*-*\"],\n  \"priority\": 900,\n  \"data_stream\": {},\n  \"template\": {\n    \"mappings\": {\n      \"_meta\": {\n        \"version\": \"1.0.0\",\n        \"catalog\": \"observability\",\n        \"type\": \"logs\",\n        \"component\": \"log\",\n        \"correlations\": [\n          {\n            \"field\": \"spanId\",\n            \"foreign-schema\": \"traces\",\n            \"foreign-field\": \"spanId\"\n          },\n          {\n            \"field\": \"traceId\",\n            \"foreign-schema\": \"traces\",\n            \"foreign-field\": \"traceId\"\n          }\n        ]\n      },\n      \"_source\": {\n        \"enabled\": true\n      },\n      \"dynamic_templates\": [\n        {\n          \"resources_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"resource.*\"\n          }\n        },\n        {\n          \"instrumentation_scope_attributes_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"instrumentationScope.attributes.*\"\n          }\n        }\n      ],\n      \"properties\": {\n        \"severity\": {\n          \"properties\": {\n            \"number\": {\n              \"type\": \"long\"\n            },\n            \"text\": {\n              \"type\": \"text\",\n              \"fields\": {\n                \"keyword\": {\n                  \"type\": \"keyword\",\n                  \"ignore_above\": 256\n                }\n              }\n            }\n          }\n        },\n        \"attributes\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"data_stream\": {\n              \"properties\": {\n                \"dataset\": {\n                  \"ignore_above\": 128,\n                  \"type\": \"keyword\"\n                },\n                \"namespace\": {\n                  \"ignore_above\": 128,\n                  \"type\": \"keyword\"\n                },\n                \"type\": {\n                  \"ignore_above\": 56,\n                  \"type\": \"keyword\"\n                }\n              }\n            }\n          }\n        },\n        \"body\": {\n          \"type\": \"text\"\n        },\n        \"@message\": {\n          \"type\": \"alias\",\n          \"path\": \"body\"\n        },\n        \"@timestamp\": {\n          \"type\": \"date\"\n        },\n        \"observedTimestamp\": {\n          \"type\": \"date\"\n        },\n        \"observerTime\": {\n          \"type\": \"alias\",\n          \"path\": \"observedTimestamp\"\n        },\n        \"traceId\": {\n          \"ignore_above\": 256,\n          \"type\": \"keyword\"\n        },\n        \"spanId\": {\n          \"ignore_above\": 256,\n          \"type\": \"keyword\"\n        },\n        \"schemaUrl\": {\n          \"type\": \"text\",\n          \"fields\": {\n            \"keyword\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 256\n            }\n          }\n        },\n        \"instrumentationScope\": {\n          \"properties\": {\n            \"name\": {\n              \"type\": \"text\",\n              \"fields\": {\n                \"keyword\": {\n                  \"type\": \"keyword\",\n                  \"ignore_above\": 128\n                }\n              }\n            },\n            \"version\": {\n              \"type\": \"text\",\n              \"fields\": {\n                \"keyword\": {\n                  \"type\": \"keyword\",\n                  \"ignore_above\": 256\n                }\n              }\n            },\n            \"dropped_attributes_count\": {\n              \"type\": \"integer\"\n            },\n            \"schemaUrl\": {\n              \"type\": \"text\",\n              \"fields\": {\n                \"keyword\": {\n                  \"type\": \"keyword\",\n                  \"ignore_above\": 256\n                }\n              }\n            }\n          }\n        },\n        \"event\": {\n          \"properties\": {\n            \"domain\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"name\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"source\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"category\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"type\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"kind\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"result\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"exception\": {\n              \"properties\": {\n                \"message\": {\n                  \"ignore_above\": 1024,\n                  \"type\": \"keyword\"\n                },\n                \"type\": {\n                  \"ignore_above\": 256,\n                  \"type\": \"keyword\"\n                },\n                \"stacktrace\": {\n                  \"type\": \"text\"\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"settings\": {\n      \"index\": {\n        \"mapping\": {\n          \"total_fields\": {\n            \"limit\": 10000\n          }\n        },\n        \"refresh_interval\": \"5s\"\n      }\n    }\n  },\n  \"composed_of\": [],\n  \"version\": 1\n}\n\n# Create the ss4o_metrics_template index template\n# >> remove the \"data_stream\":{} line to apply for indices rahter than data-streams\nPUT  _index_template/ss4o_metrics_template\n{\n  \"index_patterns\": [\n    \"ss4o_metrics-*-*\"\n  ],\n  \"data_stream\": {},\n  \"template\": {\n    \"mappings\": {\n      \"_meta\": {\n        \"version\": \"1.0.0\",\n        \"catalog\": \"observability\",\n        \"type\": \"metrics\",\n        \"component\": \"metrics\",\n        \"correlations\" : [\n          {\n            \"field\": \"spanId\",\n            \"foreign-schema\" : \"traces\",\n            \"foreign-field\" : \"spanId\"\n          },\n          {\n            \"field\": \"traceId\",\n            \"foreign-schema\" : \"traces\",\n            \"foreign-field\" : \"traceId\"\n          }\n        ]\n      },\n      \"_source\": {\n        \"enabled\": true\n      },\n      \"dynamic_templates\": [\n        {\n          \"resources_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"resource.*\"\n          }\n        },\n        {\n          \"exemplar_attributes_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"exemplar.attributes.*\"\n          }\n        },\n        {\n          \"instrumentation_scope_attributes_map\": {\n            \"mapping\": {\n              \"type\": \"keyword\"\n            },\n            \"path_match\": \"instrumentationScope.attributes.*\"\n          }\n        }\n      ],\n      \"properties\": {\n        \"name\": {\n          \"type\": \"text\",\n          \"fields\": {\n            \"keyword\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 256\n            }\n          }\n        },\n        \"attributes\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"data_stream\": {\n              \"properties\": {\n                \"dataset\": {\n                  \"ignore_above\": 128,\n                  \"type\": \"keyword\"\n                },\n                \"namespace\": {\n                  \"ignore_above\": 128,\n                  \"type\": \"keyword\"\n                },\n                \"type\": {\n                  \"ignore_above\": 56,\n                  \"type\": \"keyword\"\n                }\n              }\n            }\n          }\n        },\n        \"description\": {\n          \"type\": \"text\",\n          \"fields\": {\n            \"keyword\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 256\n            }\n          }\n        },\n        \"unit\": {\n          \"type\": \"keyword\",\n          \"ignore_above\": 128\n        },\n        \"kind\": {\n          \"type\": \"keyword\",\n          \"ignore_above\": 128\n        },\n        \"aggregationTemporality\": {\n          \"type\": \"keyword\",\n          \"ignore_above\": 128\n        },\n        \"monotonic\": {\n          \"type\": \"boolean\"\n        },\n        \"startTime\": {\n          \"type\": \"date\"\n        },\n        \"@timestamp\": {\n          \"type\": \"date\"\n        },\n        \"observedTimestamp\": {\n          \"type\": \"date_nanos\"\n        },\n        \"value@int\": {\n          \"type\": \"integer\"\n        },\n        \"value@double\": {\n          \"type\": \"double\"\n        },\n        \"buckets\": {\n          \"type\" : \"nested\",\n          \"properties\": {\n            \"count\": {\n              \"type\": \"long\"\n            },\n            \"sum\": {\n              \"type\": \"double\"\n            },\n            \"max\": {\n              \"type\": \"float\"\n            },\n            \"min\": {\n              \"type\": \"float\"\n            }\n          }\n        },\n        \"bucketCount\": {\n          \"type\": \"long\"\n        },\n        \"bucketCountsList\": {\n          \"type\": \"long\"\n        },\n        \"explicitBoundsList\": {\n          \"type\": \"float\"\n        },\n        \"explicitBoundsCount\": {\n          \"type\": \"float\"\n        },\n        \"quantiles\": {\n          \"properties\": {\n            \"quantile\": {\n              \"type\": \"double\"\n            },\n            \"value\": {\n              \"type\": \"double\"\n            }\n          }\n        },\n        \"quantileValuesCount\": {\n          \"type\": \"long\"\n        },\n        \"positiveBuckets\": {\n          \"type\" : \"nested\",\n          \"properties\": {\n            \"count\": {\n              \"type\": \"long\"\n            },\n            \"max\": {\n              \"type\": \"float\"\n            },\n            \"min\": {\n              \"type\": \"float\"\n            }\n          }\n        },\n        \"negativeBuckets\": {\n          \"type\" : \"nested\",\n          \"properties\": {\n            \"count\": {\n              \"type\": \"long\"\n            },\n            \"max\": {\n              \"type\": \"float\"\n            },\n            \"min\": {\n              \"type\": \"float\"\n            }\n          }\n        },\n        \"negativeOffset\": {\n          \"type\": \"integer\"\n        },\n        \"positiveOffset\": {\n          \"type\": \"integer\"\n        },\n        \"zeroCount\": {\n          \"type\": \"long\"\n        },\n        \"scale\": {\n          \"type\": \"long\"\n        },\n        \"max\": {\n          \"type\": \"float\"\n        },\n        \"min\": {\n          \"type\": \"float\"\n        },\n        \"sum\": {\n          \"type\": \"float\"\n        },\n        \"count\": {\n          \"type\": \"long\"\n        },\n        \"exemplar\": {\n          \"properties\": {\n            \"time\": {\n              \"type\": \"date\"\n            },\n            \"traceId\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            },\n            \"spanId\": {\n              \"ignore_above\": 256,\n              \"type\": \"keyword\"\n            }\n          }\n        },\n        \"instrumentationScope\": {\n          \"properties\": {\n            \"name\": {\n              \"type\": \"text\",\n              \"fields\": {\n                \"keyword\": {\n                  \"type\": \"keyword\",\n                  \"ignore_above\": 128\n                }\n              }\n            },\n            \"version\": {\n              \"type\": \"text\",\n              \"fields\": {\n                \"keyword\": {\n                  \"type\": \"keyword\",\n                  \"ignore_above\": 256\n                }\n              }\n            },\n            \"droppedAttributesCount\": {\n              \"type\": \"integer\"\n            },\n            \"schemaUrl\": {\n              \"type\": \"text\",\n              \"fields\": {\n                \"keyword\": {\n                  \"type\": \"keyword\",\n                  \"ignore_above\": 256\n                }\n              }\n            }\n          }\n        },\n        \"schemaUrl\": {\n          \"type\": \"text\",\n          \"fields\": {\n            \"keyword\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 256\n            }\n          }\n        }\n      }\n    },\n    \"settings\": {\n      \"index\": {\n        \"mapping\": {\n          \"total_fields\": {\n            \"limit\": 10000\n          }\n        },\n        \"refresh_interval\": \"5s\"\n      }\n    }\n  },\n  \"composed_of\": [],\n  \"version\": 1,\n  \"_meta\": {\n    \"description\": \"Observability Metrics Mapping Template\",\n    \"catalog\": \"observability\",\n    \"type\": \"metrics\",\n    \"correlations\" : [\n      {\n        \"field\": \"spanId\",\n        \"foreign-schema\" : \"traces\",\n        \"foreign-field\" : \"spanId\"\n      },\n      {\n        \"field\": \"traceId\",\n        \"foreign-schema\" : \"traces\",\n        \"foreign-field\" : \"traceId\"\n      }\n    ]\n  }\n}\n\n# Create the ss4o_services_template index template\n# >> remove the \"data_stream\":{} line to apply for indices rahter than data-streams\nPUT  _index_template/ss4o_services_template\n{\n  \"index_patterns\": [\n    \"ss4o_services-*-*\"\n  ],\n  \"template\": {\n    \"mappings\": {\n      \"_meta\": {\n        \"version\": \"1.0.0\",\n        \"catalog\": \"observability\",\n        \"type\": \"traces\",\n        \"component\": \"services\",\n        \"correlations\": [\n          {\n            \"field\": \"traceGroupName\",\n            \"foreign-schema\": \"traceGroups\",\n            \"foreign-field\": \"traceGroup\"\n          }\n        ]\n      },\n      \"_source\": {\n        \"enabled\": true\n      },\n      \"properties\": {\n        \"destination\": {\n          \"properties\": {\n            \"domain\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 1024\n            },\n            \"resource\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 1024\n            }\n          }\n        },\n        \"hashId\": {\n          \"type\": \"keyword\",\n          \"ignore_above\": 1024\n        },\n        \"serviceName\": {\n          \"type\": \"keyword\",\n          \"ignore_above\": 1024\n        },\n        \"kind\": {\n          \"type\": \"keyword\",\n          \"ignore_above\": 1024\n        },\n        \"target\": {\n          \"properties\": {\n            \"domain\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 1024\n            },\n            \"resource\": {\n              \"type\": \"keyword\",\n              \"ignore_above\": 1024\n            }\n          }\n        },\n        \"traceGroupName\": {\n          \"type\": \"keyword\",\n          \"ignore_above\": 1024\n        }\n      }\n    },\n    \"settings\": {\n      \"index\": {\n        \"mapping\": {\n          \"total_fields\": {\n            \"limit\": 10000\n          }\n        },\n        \"refresh_interval\": \"5s\"\n      }\n    }\n  },\n  \"composed_of\": [],\n  \"version\": 1,\n  \"_meta\": {\n    \"description\": \"Simple Schema For Observability Service\",\n    \"catalog\": \"observability\",\n    \"type\": \"services\",\n    \"correlations\": [\n      {\n        \"field\": \"traceGroupName\",\n        \"foreign-schema\": \"traceGroups\",\n        \"foreign-field\": \"traceGroup\"\n      }\n    ]\n  }\n}"}