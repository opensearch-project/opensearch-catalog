{"attributes":{"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"\"},\"filter\":[]}"},"title":"otel-service-investigation-flow","uiStateJSON":"{}","version":1,"visState":"{\"title\":\"otel-service-investigation-flow\",\"type\":\"vega\",\"aggs\":[],\"params\":{\"spec\":\"{\\n  \\\"$schema\\\": \\\"https://vega.github.io/schema/vega/v5.json\\\",\\n\\n  \\\"title\\\":\\\"Services Investigation Flow\\\",\\n  \\\"autosize\\\": \\\"pad\\\",\\n  \\\"padding\\\": 5,\\n  \\\"signals\\\": [\\n    { \\\"name\\\": \\\"w\\\", \\\"value\\\": 15},\\n    { \\\"name\\\": \\\"h\\\", \\\"value\\\": 15},\\n    { \\\"name\\\": \\\"aspect\\\", \\\"value\\\": true },\\n    { \\\"name\\\": \\\"smooth\\\", \\\"value\\\": true},\\n    { \\\"name\\\": \\\"align\\\", \\\"value\\\": \\\"left\\\"},\\n    { \\\"name\\\": \\\"baseline\\\", \\\"value\\\": \\\"top\\\" },\\n    {\\\"name\\\": \\\"nodeWidth\\\", \\\"value\\\": 190},\\n    {\\\"name\\\": \\\"nodeHeight\\\", \\\"value\\\": 45},\\n    {\\\"name\\\": \\\"verticalNodeGap\\\", \\\"value\\\": 10},\\n    {\\\"name\\\": \\\"horizontalNodeGap\\\", \\\"value\\\": 140},\\n    {\\n      \\\"name\\\": \\\"startingDepth\\\",\\n      \\\"value\\\": 1,\\n      \\\"on\\\": [{\\\"events\\\": {\\\"type\\\": \\\"timer\\\", \\\"throttle\\\": 0}, \\\"update\\\": \\\"-1\\\"}]\\n    },\\n    {\\n      \\\"name\\\": \\\"node\\\",\\n      \\\"value\\\": 0,\\n      \\\"on\\\": [\\n        {\\\"events\\\": {\\\"type\\\": \\\"timer\\\", \\\"throttle\\\": 10}, \\\"update\\\": \\\"0\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"nodeHighlight\\\",\\n      \\\"value\\\": \\\"[0]\\\",\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": {\\\"type\\\": \\\"mouseover\\\", \\\"markname\\\": \\\"node\\\"},\\n          \\\"update\\\": \\\"pluck(treeAncestors('treeCalcs', datum.id), 'id')\\\"\\n        },\\n        {\\\"events\\\": {\\\"type\\\": \\\"mouseout\\\"}, \\\"update\\\": \\\"[0]\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"isExpanded\\\",\\n      \\\"value\\\": 0,\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": {\\\"type\\\": \\\"click\\\", \\\"markname\\\": \\\"node\\\"},\\n          \\\"update\\\": \\\"datum.children > 0 && indata('treeClickStorePerm', 'id', datum.childrenIds[0])?true:false\\\"\\n        }\\n      ]\\n    },\\n    {\\\"name\\\": \\\"xrange\\\", \\\"update\\\": \\\"[0, width]\\\"},\\n    {\\\"name\\\": \\\"yrange\\\", \\\"update\\\": \\\"[0, height]\\\"},\\n    {\\n      \\\"name\\\": \\\"down\\\",\\n      \\\"value\\\": null,\\n      \\\"on\\\": [\\n        {\\\"events\\\": \\\"touchend\\\", \\\"update\\\": \\\"null\\\"},\\n        {\\\"events\\\": \\\"mousedown, touchstart\\\", \\\"update\\\": \\\"xy()\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"xcur\\\",\\n      \\\"value\\\": null,\\n      \\\"on\\\": [\\n        {\\\"events\\\": \\\"mousedown, touchstart, touchend\\\", \\\"update\\\": \\\"slice(xdom)\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"ycur\\\",\\n      \\\"value\\\": null,\\n      \\\"on\\\": [\\n        {\\\"events\\\": \\\"mousedown, touchstart, touchend\\\", \\\"update\\\": \\\"slice(ydom)\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"delta\\\",\\n      \\\"value\\\": [0, 0],\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": [\\n            {\\n              \\\"source\\\": \\\"window\\\",\\n              \\\"type\\\": \\\"mousemove\\\",\\n              \\\"consume\\\": true,\\n              \\\"between\\\": [\\n                {\\\"type\\\": \\\"mousedown\\\"},\\n                {\\\"source\\\": \\\"window\\\", \\\"type\\\": \\\"mouseup\\\"}\\n              ]\\n            },\\n            {\\n              \\\"type\\\": \\\"touchmove\\\",\\n              \\\"consume\\\": true,\\n              \\\"filter\\\": \\\"event.touches.length === 1\\\"\\n            }\\n          ],\\n          \\\"update\\\": \\\"down ? [down[0]-x(), down[1]-y()] : [0,0]\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"anchor\\\",\\n      \\\"value\\\": [0, 0],\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": \\\"wheel\\\",\\n          \\\"update\\\": \\\"[invert('xscale', x()), invert('yscale', y())]\\\"\\n        },\\n        {\\n          \\\"events\\\": {\\n            \\\"type\\\": \\\"touchstart\\\",\\n            \\\"filter\\\": \\\"event.touches.length===2\\\"\\n          },\\n          \\\"update\\\": \\\"[(xdom[0] + xdom[1]) / 2, (ydom[0] + ydom[1]) / 2]\\\"\\n        }\\n      ]\\n    },\\n    {\\\"name\\\": \\\"xext\\\", \\\"update\\\": \\\"[0,width]\\\"},\\n    {\\\"name\\\": \\\"yext\\\", \\\"update\\\": \\\"[0,height]\\\"},\\n    {\\n      \\\"name\\\": \\\"zoom\\\",\\n      \\\"value\\\": 1,\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": \\\"wheel!\\\",\\n          \\\"force\\\": true,\\n          \\\"update\\\": \\\"pow(1.001, event.deltaY * pow(16, event.deltaMode))\\\"\\n        },\\n        {\\n          \\\"events\\\": {\\\"signal\\\": \\\"dist2\\\"},\\n          \\\"force\\\": true,\\n          \\\"update\\\": \\\"dist1 / dist2\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"dist1\\\",\\n      \\\"value\\\": 0,\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": {\\n            \\\"type\\\": \\\"touchstart\\\",\\n            \\\"filter\\\": \\\"event.touches.length===2\\\"\\n          },\\n          \\\"update\\\": \\\"pinchDistance(event)\\\"\\n        },\\n        {\\\"events\\\": {\\\"signal\\\": \\\"dist2\\\"}, \\\"update\\\": \\\"dist2\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"dist2\\\",\\n      \\\"value\\\": 0,\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": {\\n            \\\"type\\\": \\\"touchmove\\\",\\n            \\\"consume\\\": true,\\n            \\\"filter\\\": \\\"event.touches.length===2\\\"\\n          },\\n          \\\"update\\\": \\\"pinchDistance(event)\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"xdom\\\",\\n      \\\"update\\\": \\\"slice(xext)\\\",\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": {\\\"signal\\\": \\\"delta\\\"},\\n          \\\"update\\\": \\\"[xcur[0] + span(xcur) * delta[0] / width, xcur[1] + span(xcur) * delta[0] / width]\\\"\\n        },\\n        {\\n          \\\"events\\\": {\\\"signal\\\": \\\"zoom\\\"},\\n          \\\"update\\\": \\\"[anchor[0] + (xdom[0] - anchor[0]) * zoom, anchor[0] + (xdom[1] - anchor[0]) * zoom]\\\"\\n        },\\n        {\\\"events\\\": \\\"dblclick\\\", \\\"update\\\": \\\"[0,width]\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"ydom\\\",\\n      \\\"update\\\": \\\"slice(yext)\\\",\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": {\\\"signal\\\": \\\"delta\\\"},\\n          \\\"update\\\": \\\"[ycur[0] + span(ycur) * delta[1] / height, ycur[1] + span(ycur) * delta[1] / height]\\\"\\n        },\\n        {\\n          \\\"events\\\": {\\\"signal\\\": \\\"zoom\\\"},\\n          \\\"update\\\": \\\"[anchor[1] + (ydom[0] - anchor[1]) * zoom, anchor[1] + (ydom[1] - anchor[1]) * zoom]\\\"\\n        },\\n        {\\\"events\\\": \\\"dblclick\\\", \\\"update\\\": \\\"[0,height]\\\"}\\n      ]\\n    },\\n    {\\\"name\\\": \\\"scaledImgW\\\", \\\"update\\\": \\\"(w/ span(xdom))*width\\\"},\\n    {\\n      \\\"name\\\": \\\"scaledImgH\\\",\\n      \\\"update\\\": \\\"abs(h/ span(ydom))*height\\\"\\n    },\\n\\n    {\\\"name\\\": \\\"scaledNodeWidth\\\", \\\"update\\\": \\\"(nodeWidth/ span(xdom))*width\\\"},\\n    {\\n      \\\"name\\\": \\\"scaledNodeHeight\\\",\\n      \\\"update\\\": \\\"abs(nodeHeight/ span(ydom))*height\\\"\\n    },\\n    {\\\"name\\\": \\\"scaledFont13\\\", \\\"update\\\": \\\"(13/ span(xdom))*width\\\"},\\n    {\\\"name\\\": \\\"scaledFont12\\\", \\\"update\\\": \\\"(12/ span(xdom))*width\\\"},\\n    {\\\"name\\\": \\\"scaledFont11\\\", \\\"update\\\": \\\"(11/ span(xdom))*width\\\"},\\n    {\\\"name\\\": \\\"scaledKPIHeight\\\", \\\"update\\\": \\\"(5/ span(xdom))*width\\\"},\\n    {\\\"name\\\": \\\"scaledLimit\\\", \\\"update\\\": \\\"(20/ span(xdom))*width\\\"}\\n  ],\\n  \\\"data\\\": [\\n    {\\n      \\\"name\\\": \\\"source\\\",\\n      \\\"values\\\": [\\n        { \\\"level1\\\": \\\"OTEL\\\", \\\"details\\\": \\\"Install Integration\\\",\\n          \\\"info\\\":{\\n            \\\"name\\\":\\\"OTEL Integration\\\",\\n            \\\"description\\\":\\\"Go here to read the documentation of the OTEL services\\\",\\n            \\\"references\\\":\\\"https://opentelemetry.io/\\\"\\n          },\\n          \\\"url\\\":\\\"http://localhost:5601/app/integrations#/available/otel-services\\\", \\\"kpi\\\": 75 },\\n        {\\n          \\\"level1\\\": \\\"OTEL\\\",\\n          \\\"level2\\\": \\\"OTEL Ingestion\\\",\\n          \\\"details\\\": \\\"Inspect Signal Rates\\\",\\n          \\\"info\\\":{\\n            \\\"name\\\":\\\"OTEL Ingestion\\\",\\n            \\\"description\\\":\\\"Go here to review the (OTEL) signals ingestion rate\\\",\\n            \\\"references\\\":\\\"https://opensearch.org/docs/latest/data-prepper/\\\"\\n          },\\n          \\\"url\\\":\\\"http://localhost:5601/app/dashboards#/view/data-ingestion-rate-dashboard-1_0_0_ID\\\",\\n          \\\"kpi\\\": 80\\n        },\\n        {\\n          \\\"level1\\\": \\\"OTEL\\\",\\n          \\\"level2\\\": \\\"OTEL Integrations\\\",\\n          \\\"details\\\": \\\"Services Dashboard\\\",\\n          \\\"url\\\":\\\"http://localhost:5601/app/dashboards#/view/otel-services-dashboard-1_0_0_ID\\\",\\n          \\\"info\\\":{\\n            \\\"name\\\":\\\"OTEL Services\\\",\\n            \\\"description\\\":\\\"Go here to monitor the application's services\\\",\\n            \\\"references\\\":\\\"https://opentelemetry.io/docs/demo/services/\\\"\\n          },\\n          \\\"kpi\\\": 50\\n        },\\n        {\\n          \\\"level1\\\": \\\"OTEL\\\",\\n          \\\"level2\\\": \\\"OTEL Integrations\\\",\\n          \\\"level3\\\" : \\\"Single Services Dashboard\\\",\\n          \\\"details\\\": \\\"Deep Dive Service Details\\\",\\n          \\\"info\\\":{\\n            \\\"name\\\":\\\"Single Service Deep Dive\\\",\\n            \\\"description\\\":\\\"Go here to analyze and monitor a specific service\\\",\\n            \\\"references\\\":\\\"https://opentelemetry.io/docs/demo/services/\\\"\\n          },\\n          \\\"url\\\":\\\"http://localhost:5601/app/dashboards#/view/single-service-correlated-dashboard-1_0_0_ID\\\",\\n          \\\"kpi\\\": 50\\n        },\\n        {\\n          \\\"level1\\\": \\\"OTEL\\\",\\n          \\\"level2\\\": \\\"OTEL Integrations\\\",\\n          \\\"level3\\\" : \\\"Single Services Dashboard\\\",\\n          \\\"level4\\\" : \\\"Service System Details\\\",\\n          \\\"details\\\": \\\"Service System Metrics\\\",\\n          \\\"url\\\":\\\"http://localhost:5601/app/dashboards#/view/apm-system-metrics-dashboard-1_0_0_ID\\\",\\n          \\\"info\\\":{\\n            \\\"name\\\":\\\"APM System Metrics Monitor\\\",\\n            \\\"description\\\":\\\"Go here to analyze the services system's metrics \\\",\\n            \\\"references\\\":\\\"https://opentelemetry.io/docs/concepts/signals/metrics/\\\"\\n          },\\n          \\\"kpi\\\": 50\\n        },\\n        {\\n          \\\"level1\\\": \\\"OTEL\\\",\\n          \\\"level2\\\": \\\"OTEL Integrations\\\",\\n          \\\"level3\\\" : \\\"Single Services Dashboard\\\",\\n          \\\"level4\\\" : \\\"Service Network Details\\\",\\n          \\\"info\\\":{\\n            \\\"name\\\":\\\"APM Network Metrics Monitor\\\",\\n            \\\"description\\\":\\\"Go here to analyze the services network's metrics \\\",\\n            \\\"references\\\":\\\"https://opentelemetry.io/docs/concepts/signals/metrics/\\\"\\n          },\\n          \\\"details\\\": \\\"Service Network Metrics\\\",\\n          \\\"url\\\":\\\"http://localhost:5601/app/dashboards#/view/apm-network-metrics-dashboard-1_0_0_ID\\\",\\n          \\\"kpi\\\": 50\\n        }]},\\n    {\\n      \\\"name\\\": \\\"wideToTall\\\",\\n      \\\"source\\\": \\\"source\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"{key: datum.level1,parent: null, details:datum.details, kpi:datum.kpi, link:datum.url, info:datum.info}\\\",\\n          \\\"as\\\": \\\"l1\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"{key: datum.level1+ '|'+datum.level2,parent: datum.level1, details:datum.details, kpi:datum.kpi, link:datum.url, info:datum.info}\\\",\\n          \\\"as\\\": \\\"l2\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"{key:datum.level1 + '|'+datum.level2+ '|'+datum.level3,parent: datum.level1+ '|'+datum.level2, details:datum.details, kpi:datum.kpi, link:datum.url, info:datum.info}\\\",\\n          \\\"as\\\": \\\"l3\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"{key:datum.level1 + '|'+datum.level2+ '|'+datum.level3+ '|'+ datum.level4,parent: datum.level1 + '|'+datum.level2+ '|'+datum.level3, details:datum.details, kpi:datum.kpi, link:datum.url, info:datum.info}\\\",\\n          \\\"as\\\": \\\"l4\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"{key:datum.level1 + '|'+datum.level2+ '|'+datum.level3+ '|'+ datum.level4+ '|'+ datum.level5,parent: datum.level1 + '|'+datum.level2+ '|'+datum.level3+ '|'+ datum.level4, details:datum.details, link:datum.url, info:datum.info, kpi:datum.kpi}\\\",\\n          \\\"as\\\": \\\"l5\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"{key:datum.level1 + '|'+datum.level2+ '|'+datum.level3+ '|'+ datum.level4+ '|'+ datum.level5+ '|'+ datum.level6,parent: datum.level1 + '|'+datum.level2+ '|'+datum.level3+ '|'+ datum.level4+ '|'+ datum.level5, details:datum.details, link:datum.url, info:datum.info, kpi:datum.kpi}\\\",\\n          \\\"as\\\": \\\"l6\\\"\\n        },\\n        {\\\"type\\\": \\\"fold\\\", \\\"fields\\\": [\\\"l1\\\", \\\"l2\\\", \\\"l3\\\", \\\"l4\\\", \\\"l5\\\",\\\"l6\\\"]},\\n        {\\\"type\\\": \\\"project\\\", \\\"fields\\\": [\\\"key\\\", \\\"value\\\"]},\\n        {\\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.value.key\\\", \\\"as\\\": \\\"id\\\"},\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"reverse(split(datum.value.key,'|'))[0]\\\",\\n          \\\"as\\\": \\\"title\\\"\\n        },\\n        {\\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.value.parent\\\", \\\"as\\\": \\\"parent\\\"},\\n        {\\n          \\\"type\\\": \\\"filter\\\",\\n          \\\"expr\\\": \\\"datum.title != 'null' && datum.title != 'undefined'\\\"\\n        },\\n        {\\\"type\\\": \\\"aggregate\\\", \\\"groupby\\\": [\\\"id\\\", \\\"parent\\\", \\\"title\\\", \\\"value\\\"]},\\n        {\\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.value.details\\\", \\\"as\\\": \\\"details\\\"},\\n        {\\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.value.kpi\\\", \\\"as\\\": \\\"kpi\\\"},\\n        {\\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.value.link\\\", \\\"as\\\": \\\"link\\\"},\\n        {\\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.value.info\\\", \\\"as\\\": \\\"info\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"treeCalcs\\\",\\n      \\\"source\\\": \\\"wideToTall\\\",\\n      \\\"transform\\\": [\\n        {\\\"type\\\": \\\"stratify\\\", \\\"key\\\": \\\"id\\\", \\\"parentKey\\\": \\\"parent\\\"},\\n        {\\n          \\\"type\\\": \\\"tree\\\",\\n          \\\"method\\\": {\\\"signal\\\": \\\"'tidy'\\\"},\\n          \\\"separation\\\": {\\\"signal\\\": \\\"false\\\"},\\n          \\\"as\\\": [\\\"y\\\", \\\"x\\\", \\\"depth\\\", \\\"children\\\"]\\n        },\\n        {\\\"as\\\": \\\"parent\\\", \\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.parent\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"treeChildren\\\",\\n      \\\"source\\\": \\\"treeCalcs\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"aggregate\\\",\\n          \\\"groupby\\\": [\\\"parent\\\"],\\n          \\\"fields\\\": [\\\"parent\\\"],\\n          \\\"ops\\\": [\\\"values\\\"],\\n          \\\"as\\\": [\\\"childrenObjects\\\"]\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"pluck(datum.childrenObjects,'id')\\\",\\n          \\\"as\\\": \\\"childrenIds\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"treeAncestors\\\",\\n      \\\"source\\\": \\\"treeCalcs\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"as\\\": \\\"treeAncestors\\\",\\n          \\\"expr\\\": \\\"treeAncestors('treeCalcs', datum.id, 'root')\\\"\\n        },\\n        {\\\"type\\\": \\\"flatten\\\", \\\"fields\\\": [\\\"treeAncestors\\\"]},\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"datum.treeAncestors.parent\\\",\\n          \\\"as\\\": \\\"allParents\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"treeChildrenAll\\\",\\n      \\\"source\\\": \\\"treeAncestors\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"project\\\",\\n          \\\"fields\\\": [\\n            \\\"allParents\\\",\\n            \\\"id\\\",\\n            \\\"name\\\",\\n            \\\"parent\\\",\\n            \\\"x\\\",\\n            \\\"y\\\",\\n            \\\"depth\\\",\\n            \\\"children\\\"\\n          ]\\n        },\\n        {\\n          \\\"type\\\": \\\"aggregate\\\",\\n          \\\"fields\\\": [\\\"parent\\\", \\\"parent\\\", \\\"id\\\"],\\n          \\\"ops\\\": [\\\"values\\\", \\\"count\\\", \\\"min\\\"],\\n          \\\"groupby\\\": [\\\"allParents\\\"],\\n          \\\"as\\\": [\\\"allChildrenObjects\\\", \\\"allChildrenCount\\\", \\\"id\\\"]\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"pluck(datum.allChildrenObjects,'id')\\\",\\n          \\\"as\\\": \\\"allChildrenIds\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"treeClickStoreTemp\\\",\\n      \\\"source\\\": \\\"treeAncestors\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"project\\\",\\n          \\\"fields\\\": [\\\"id\\\", \\\"name\\\", \\\"parent\\\", \\\"x\\\", \\\"y\\\", \\\"depth\\\", \\\"children\\\"]\\n        },\\n        {\\n          \\\"type\\\": \\\"aggregate\\\",\\n          \\\"fields\\\": [\\\"id\\\"],\\n          \\\"ops\\\": [\\\"min\\\"],\\n          \\\"groupby\\\": [\\\"id\\\", \\\"name\\\", \\\"parent\\\", \\\"x\\\", \\\"y\\\", \\\"depth\\\", \\\"children\\\"]\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"treeClickStorePerm\\\",\\n      \\\"values\\\": [],\\n      \\\"on\\\": [\\n        {\\\"trigger\\\": \\\"startingDepth>=0\\\", \\\"insert\\\": \\\"data('treeClickStoreTemp')\\\"},\\n        {\\n          \\\"trigger\\\": \\\"node\\\",\\n          \\\"insert\\\": \\\"!isExpanded? data('treeClickStoreTemp'):false\\\"\\n        },\\n        {\\n          \\\"trigger\\\": \\\"node\\\",\\n          \\\"remove\\\": \\\"isExpanded?data('treeClickStoreTemp'):false\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"treeLayout\\\",\\n      \\\"source\\\": \\\"wideToTall\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"filter\\\",\\n          \\\"expr\\\": \\\"indata('treeClickStorePerm', 'id', datum.id)\\\"\\n        },\\n        {\\\"type\\\": \\\"stratify\\\", \\\"key\\\": \\\"id\\\", \\\"parentKey\\\": \\\"parent\\\"},\\n        {\\n          \\\"type\\\": \\\"tree\\\",\\n          \\\"method\\\": {\\\"signal\\\": \\\"'tidy'\\\"},\\n          \\\"nodeSize\\\": [\\n            {\\\"signal\\\": \\\"nodeHeight+verticalNodeGap\\\"},\\n            {\\\"signal\\\": \\\"nodeWidth+horizontalNodeGap\\\"}\\n          ],\\n          \\\"separation\\\": {\\\"signal\\\": \\\"false\\\"},\\n          \\\"as\\\": [\\\"y\\\", \\\"x\\\", \\\"depth\\\", \\\"children\\\"]\\n        },\\n        {\\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.y+(height/2)\\\", \\\"as\\\": \\\"y\\\"},\\n        {\\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"scale('xscale',datum.x)\\\", \\\"as\\\": \\\"xscaled\\\"},\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"datum.info\\\",\\n          \\\"as\\\": \\\"info\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"datum.link\\\",\\n          \\\"as\\\": \\\"link\\\"\\n        },\\n        {\\\"as\\\": \\\"parent\\\", \\\"type\\\": \\\"formula\\\", \\\"expr\\\": \\\"datum.parent\\\"}\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"fullTreeLayout\\\",\\n      \\\"source\\\": \\\"treeLayout\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"lookup\\\",\\n          \\\"from\\\": \\\"treeChildren\\\",\\n          \\\"key\\\": \\\"parent\\\",\\n          \\\"fields\\\": [\\\"id\\\"],\\n          \\\"values\\\": [\\\"childrenObjects\\\", \\\"childrenIds\\\"]\\n        },\\n        {\\n          \\\"type\\\": \\\"lookup\\\",\\n          \\\"from\\\": \\\"treeChildrenAll\\\",\\n          \\\"key\\\": \\\"allParents\\\",\\n          \\\"fields\\\": [\\\"id\\\"],\\n          \\\"values\\\": [\\\"allChildrenIds\\\", \\\"allChildrenObjects\\\"]\\n        },\\n        {\\n          \\\"type\\\": \\\"lookup\\\",\\n          \\\"from\\\": \\\"treeCalcs\\\",\\n          \\\"key\\\": \\\"id\\\",\\n          \\\"fields\\\": [\\\"id\\\"],\\n          \\\"values\\\": [\\\"children\\\"]\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"reverse(pluck(treeAncestors('treeCalcs', datum.id), 'id'))[1]\\\",\\n          \\\"as\\\": \\\"treeParent\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"visibleNodes\\\",\\n      \\\"source\\\": \\\"fullTreeLayout\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"filter\\\",\\n          \\\"expr\\\": \\\"indata('treeClickStorePerm', 'id', datum.id)\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"maxWidthAndHeight\\\",\\n      \\\"source\\\": \\\"visibleNodes\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"aggregate\\\",\\n          \\\"groupby\\\": [\\\"depth\\\"],\\n          \\\"fields\\\": [\\\"depth\\\", \\\"x\\\", \\\"y\\\"],\\n          \\\"ops\\\": [\\\"count\\\", \\\"max\\\", \\\"max\\\"],\\n          \\\"as\\\": [\\\"count\\\", \\\"x\\\", \\\"y\\\"]\\n        },\\n        {\\n          \\\"type\\\": \\\"aggregate\\\",\\n          \\\"fields\\\": [\\\"depth\\\", \\\"count\\\", \\\"x\\\", \\\"y\\\"],\\n          \\\"ops\\\": [\\\"max\\\", \\\"max\\\", \\\"max\\\", \\\"max\\\"],\\n          \\\"as\\\": [\\\"maxDepth\\\", \\\"maxNodes\\\", \\\"maxX\\\", \\\"maxY\\\"]\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"links\\\",\\n      \\\"source\\\": \\\"treeLayout\\\",\\n      \\\"transform\\\": [\\n        {\\\"type\\\": \\\"treelinks\\\"},\\n        {\\n          \\\"type\\\": \\\"linkpath\\\",\\n          \\\"orient\\\": \\\"horizontal\\\",\\n          \\\"shape\\\": \\\"diagonal\\\",\\n          \\\"sourceY\\\": {\\\"expr\\\": \\\"scale('yscale', datum.source.y)\\\"},\\n          \\\"sourceX\\\": {\\\"expr\\\": \\\"scale('xscale', datum.source.x+nodeWidth)\\\"},\\n          \\\"targetY\\\": {\\\"expr\\\": \\\"scale('yscale', datum.target.y)\\\"},\\n          \\\"targetX\\\": {\\\"expr\\\": \\\"scale('xscale', datum.target.x)\\\"}\\n        },\\n        {\\n          \\\"type\\\": \\\"filter\\\",\\n          \\\"expr\\\": \\\" indata('treeClickStorePerm', 'id', datum.target.id)\\\"\\n        }\\n      ]\\n    }\\n  ],\\n  \\\"scales\\\": [\\n    {\\n      \\\"name\\\": \\\"xscale\\\",\\n      \\\"zero\\\": false,\\n      \\\"domain\\\": {\\\"signal\\\": \\\"xdom\\\"},\\n      \\\"range\\\": {\\\"signal\\\": \\\"xrange\\\"}\\n    },\\n    {\\n      \\\"name\\\": \\\"yscale\\\",\\n      \\\"zero\\\": false,\\n      \\\"domain\\\": {\\\"signal\\\": \\\"ydom\\\"},\\n      \\\"range\\\": {\\\"signal\\\": \\\"yrange\\\"}\\n    },\\n    {\\n      \\\"name\\\": \\\"kpiscale\\\",\\n      \\\"zero\\\": false,\\n      \\\"domain\\\": [0, 100],\\n      \\\"range\\\": {\\\"signal\\\": \\\"[0,scaledNodeWidth]\\\"}\\n    },\\n    {\\n      \\\"name\\\": \\\"colour\\\",\\n      \\\"type\\\": \\\"ordinal\\\",\\n      \\\"range\\\": [\\n        \\\"#6f6f6f\\\",\\n        \\\"#4472C4\\\",\\n        \\\"#3A8E50\\\",\\n        \\\"#ED7D31\\\",\\n        \\\"#a63939\\\",\\n        \\\"#6338a6\\\",\\n        \\\"#3843a6\\\",\\n        \\\"#38a695\\\"\\n      ],\\n      \\\"domain\\\": {\\\"data\\\": \\\"visibleNodes\\\", \\\"field\\\": \\\"treeParent\\\"}\\n    }\\n  ],\\n  \\\"marks\\\": [\\n    {\\n      \\\"type\\\": \\\"path\\\",\\n      \\\"interactive\\\": false,\\n      \\\"from\\\": {\\\"data\\\": \\\"links\\\"},\\n      \\\"encode\\\": {\\n        \\\"update\\\": {\\n          \\\"path\\\": {\\\"field\\\": \\\"path\\\"},\\n          \\\"strokeWidth\\\": {\\n            \\\"signal\\\": \\\"indexof(nodeHighlight, datum.target.id)> -1? 2.5:0.4\\\"\\n          },\\n          \\\"stroke\\\": {\\n            \\\"scale\\\": \\\"colour\\\",\\n            \\\"signal\\\": \\\"reverse(pluck(treeAncestors('treeCalcs', datum.target.id), 'id'))[1]\\\"\\n          }\\n        }\\n      }\\n    },\\n    {\\n      \\\"name\\\": \\\"node\\\",\\n      \\\"description\\\": \\\"The parent node\\\",\\n      \\\"type\\\": \\\"group\\\",\\n      \\\"clip\\\": false,\\n      \\\"from\\\": {\\\"data\\\": \\\"visibleNodes\\\"},\\n      \\\"encode\\\": {\\n        \\\"update\\\": {\\n          \\\"x\\\": {\\\"field\\\": \\\"x\\\", \\\"scale\\\": \\\"xscale\\\"},\\n          \\\"width\\\": {\\\"signal\\\": \\\"scaledNodeWidth\\\"},\\n          \\\"yc\\\": {\\\"field\\\": \\\"y\\\", \\\"scale\\\": \\\"yscale\\\"},\\n          \\\"height\\\": {\\\"signal\\\": \\\"scaledNodeHeight\\\"},\\n          \\\"fill\\\": {\\n            \\\"signal\\\": \\\"merge(hsl(scale('colour', datum.treeParent)), {l:0.94})\\\"\\n          },\\n          \\\"stroke\\\": {\\n            \\\"signal\\\": \\\"merge(hsl(scale('colour', datum.treeParent)), {l:0.79})\\\"\\n          },\\n          \\\"cornerRadius\\\": {\\\"value\\\": 2},\\n          \\\"cursor\\\": {\\\"signal\\\": \\\"datum.children>0?'pointer':''\\\"},\\n          \\\"tooltip\\\": {\\\"signal\\\": \\\"\\\"}\\n        }\\n      },\\n      \\\"marks\\\": [\\n        {\\n          \\\"name\\\": \\\"linkImage\\\",\\n          \\\"type\\\": \\\"image\\\",\\n          \\\"interactive\\\": true,\\n          \\\"encode\\\": {\\n            \\\"enter\\\": {\\n              \\\"url\\\": {\\\"value\\\": \\\"https://icons.veryicon.com/png/o/education-technology/product-icon-of-apstar-big-data/opensearch-blue.png\\\"}\\n            },\\n            \\\"update\\\": {\\n              \\\"opacity\\\": {\\\"value\\\": 1},\\n              \\\"x\\\": {\\\"signal\\\": \\\"(180/ span(xdom))*width\\\"},\\n              \\\"y\\\": {\\\"signal\\\": \\\"-10\\\"},\\n              \\\"width\\\": {\\\"signal\\\": \\\"scaledImgW\\\"},\\n              \\\"height\\\": {\\\"signal\\\": \\\"scaledImgH\\\"},\\n              \\\"aspect\\\": {\\\"signal\\\": \\\"aspect\\\"},\\n              \\\"smooth\\\": {\\\"signal\\\": \\\"smooth\\\"},\\n              \\\"align\\\": {\\\"signal\\\": \\\"align\\\"},\\n              \\\"baseline\\\": {\\\"signal\\\": \\\"baseline\\\"},\\n              \\\"tooltip\\\": {\\\"signal\\\": \\\"parent.info\\\"}\\n\\n            },\\n            \\\"hover\\\": {\\n              \\\"opacity\\\": {\\\"value\\\": 0.5}\\n            }\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"infoImage\\\",\\n          \\\"type\\\": \\\"image\\\",\\n          \\\"interactive\\\": true,\\n          \\\"encode\\\": {\\n            \\\"enter\\\": {\\n              \\\"url\\\": {\\\"value\\\": \\\"https://opensearch.org/assets/brand/SVG/Mark/opensearch_mark_default.svg\\\"}\\n            },\\n            \\\"update\\\": {\\n              \\\"href\\\": {\\\"signal\\\":\\\"parent.link\\\"},\\n              \\\"opacity\\\": {\\\"value\\\": 1},\\n              \\\"x\\\": {\\\"signal\\\": \\\"item.mark.group.x1\\\"},\\n              \\\"y\\\": {\\\"signal\\\": \\\"-10\\\"},\\n              \\\"width\\\": {\\\"signal\\\": \\\"scaledImgW\\\"},\\n              \\\"height\\\": {\\\"signal\\\": \\\"scaledImgH\\\"},\\n              \\\"aspect\\\": {\\\"signal\\\": \\\"aspect\\\"},\\n              \\\"smooth\\\": {\\\"signal\\\": \\\"smooth\\\"},\\n              \\\"align\\\": {\\\"signal\\\": \\\"align\\\"},\\n              \\\"baseline\\\": {\\\"signal\\\": \\\"baseline\\\"}\\n            },\\n            \\\"hover\\\": {\\n              \\\"opacity\\\": {\\\"value\\\": 0.5}\\n            }\\n          }\\n        },\\n\\n        {\\n          \\\"name\\\": \\\"highlight\\\",\\n          \\\"description\\\": \\\"highlight (seems like a Vega bug as this doens't work on the group element)\\\",\\n          \\\"type\\\": \\\"rect\\\",\\n          \\\"interactive\\\": false,\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\\"signal\\\": \\\"item.mark.group.x1\\\"},\\n              \\\"y\\\": {\\\"signal\\\": \\\"0\\\"},\\n              \\\"fill\\\": {\\n                \\\"signal\\\": \\\"indexof(nodeHighlight, parent.id)> -1? merge(hsl(scale('colour', parent.treeParent)), {l:0.82}):0\\\"\\n              },\\n              \\\"stroke\\\": {\\n                \\\"signal\\\": \\\"indexof(nodeHighlight, parent.id)> -1? merge(hsl(scale('colour', parent.treeParent)), {l:0.79}):0\\\"\\n              },\\n              \\\"height\\\": {\\\"signal\\\": \\\"item.mark.group.height\\\"},\\n              \\\"width\\\": {\\\"signal\\\": \\\"item.mark.group.width\\\"}\\n            }\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"KPI background\\\",\\n          \\\"description\\\": \\\"KPI background\\\",\\n          \\\"type\\\": \\\"rect\\\",\\n          \\\"interactive\\\": false,\\n          \\\"clip\\\": true,\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\\"signal\\\": \\\"item.mark.group.x1\\\"},\\n              \\\"y\\\": {\\\"signal\\\": \\\"item.mark.group.height-scaledKPIHeight\\\"},\\n              \\\"height\\\": {\\\"signal\\\": \\\"scaledKPIHeight\\\"},\\n              \\\"width\\\": {\\\"signal\\\": \\\"(item.mark.group.width)\\\"},\\n              \\\"fill\\\": {\\\"scale\\\": \\\"colour\\\", \\\"signal\\\": \\\"parent.treeParent\\\"},\\n              \\\"opacity\\\": {\\\"value\\\": 0.2}\\n            }\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"KPI\\\",\\n          \\\"description\\\": \\\"KPI\\\",\\n          \\\"type\\\": \\\"rect\\\",\\n          \\\"interactive\\\": false,\\n          \\\"clip\\\": true,\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\\"signal\\\": \\\"item.mark.group.x1\\\"},\\n              \\\"y\\\": {\\\"signal\\\": \\\"item.mark.group.height-scaledKPIHeight\\\"},\\n              \\\"height\\\": {\\\"signal\\\": \\\"scaledKPIHeight\\\"},\\n              \\\"width\\\": {\\\"signal\\\": \\\"scale('kpiscale',parent.kpi)\\\"},\\n              \\\"fill\\\": {\\\"scale\\\": \\\"colour\\\", \\\"signal\\\": \\\"parent.treeParent\\\"}\\n            }\\n          }\\n        },\\n        {\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"interactive\\\": false,\\n          \\\"name\\\": \\\"name\\\",\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\\"signal\\\": \\\"(10/ span(xdom))*width\\\"},\\n              \\\"y\\\": {\\\"signal\\\": \\\"(6/ span(xdom))*width\\\"},\\n              \\\"fontWeight\\\": {\\\"value\\\": \\\"600\\\"},\\n              \\\"baseline\\\": {\\\"value\\\": \\\"top\\\"},\\n              \\\"fill\\\": {\\\"scale\\\": \\\"colour\\\", \\\"signal\\\": \\\"parent.treeParent\\\"},\\n              \\\"text\\\": {\\\"signal\\\": \\\"parent.details\\\"},\\n              \\\"fontSize\\\": {\\\"signal\\\": \\\"scaledFont13\\\"},\\n              \\\"limit\\\": {\\\"signal\\\": \\\"scaledNodeWidth-scaledLimit\\\"},\\n              \\\"font\\\": {\\\"value\\\": \\\"Calibri\\\"}\\n            }\\n          }\\n        },\\n        {\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"interactive\\\": false,\\n          \\\"name\\\": \\\"title\\\",\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\\"signal\\\": \\\"(10/ span(xdom))*width\\\"},\\n              \\\"y\\\": {\\\"signal\\\": \\\"(22/ span(xdom))*width\\\"},\\n              \\\"align\\\": {\\\"value\\\": \\\"left\\\"},\\n              \\\"baseline\\\": {\\\"value\\\": \\\"top\\\"},\\n              \\\"fill\\\": {\\\"signal\\\": \\\"'#4D4B44'\\\"},\\n              \\\"text\\\": {\\\"signal\\\": \\\"parent.title\\\"},\\n              \\\"fontSize\\\": {\\\"signal\\\": \\\"scaledFont11\\\"},\\n              \\\"limit\\\": {\\\"signal\\\": \\\"scaledNodeWidth-scaledLimit\\\"},\\n              \\\"font\\\": {\\\"value\\\": \\\"Calibri\\\"}\\n            }\\n          }\\n        },\\n        {\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"interactive\\\": false,\\n          \\\"name\\\": \\\"node children\\\",\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\\"signal\\\": \\\"item.mark.group.width - (9/ span(xdom))*width\\\"},\\n              \\\"y\\\": {\\\"signal\\\": \\\"item.mark.group.height/2\\\"},\\n              \\\"align\\\": {\\\"value\\\": \\\"right\\\"},\\n              \\\"baseline\\\": {\\\"value\\\": \\\"middle\\\"},\\n              \\\"fill\\\": {\\\"scale\\\": \\\"colour\\\", \\\"signal\\\": \\\"parent.treeParent\\\"},\\n              \\\"text\\\": {\\\"signal\\\": \\\"parent.children>0?parent.children:''\\\"},\\n              \\\"fontSize\\\": {\\\"signal\\\": \\\"scaledFont12\\\"},\\n              \\\"font\\\": {\\\"value\\\": \\\"Calibri\\\"}\\n            }\\n          }\\n        }\\n      ]\\n    }\\n  ]\\n}\"}}"},"id":"375873f0-121d-11ef-b612-e9a167e5758e","migrationVersion":{"visualization":"7.10.0"},"references":[],"type":"visualization","updated_at":"2024-05-17T06:45:46.635Z","version":"WzUzLDJd"}
{"exportedCount":1,"missingRefCount":0,"missingReferences":[]}z